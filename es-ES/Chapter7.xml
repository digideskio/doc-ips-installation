<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
<!ENTITY % BOOK_ENTITIES SYSTEM "manual.ent">
<!ENTITY PRODUCT "Documentation">
<!ENTITY BOOKID "manual">
<!ENTITY YEAR "2015">
<!ENTITY HOLDER "Eneo Tecnología S.L. |">
]>
<chapter>
	<title>Creación de una Signature Policy en redBorder</title>
	<para>Una vez que disponemos de versiones de reglas descargadas en la sección <literal>Tools>Rule's version</literal> ya estamos en condiciones de poder crear una nueva <emphasis role="bold">Signature policy.</emphasis></para> 
	<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="450" fileref="images/ch05_img001.png"/>
			</imageobject>
			<caption>
				<para>Sección Tools: Rule's versions</para>
			</caption>
		</mediaobject>
    <section>
		<title>Creación de una Signature Policy</title>
		<para>Una Signature Policy es un subconjunto de reglas o selección obtenida a partir de una o más "versiones" de reglas descargadas.</para>
		<para>Para crear una Signature Policy nos dirigimos a la sección <literal>Sensors</literal> donde tenemos los sensores registrados, y en las opciones del sensor (icono de la derecha) seleccionamos Signature Policies.</para> 
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="450" fileref="images/ch05_img002.png"/>
			</imageobject>
			<caption>
				<para>Sensors: Signature Policies</para>
			</caption>
		</mediaobject>
		<para>En la interfaz de Signature Policy se muestran todas las políticas creadas hasta el momento (en este caso ninguna). Para crear una nueva pulsamos sobre <literal>New Policy.</literal></para>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="450" fileref="images/ch05_img003.png"/>
			</imageobject>
			<caption>
				<para>Añadir nueva política</para>
			</caption>
        </mediaobject>
        <para>A continuación nos aparecerá una ventana emergente en la que introduciremos los datos de la nueva política a crear: Nombre, descripción, usuario propietario, fuentes de reglas y versiones disponibles. 
        Debemos de seleccionar la fuente de reglas y la versión de la misma a partir de la cual crearemos la política de firmas (se permiten múltiples).</para> 
        <mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch05_img004.png"/>
				</imageobject>
				<caption>
					<para>Crear una nueva política de reglas</para>
				</caption>
			</mediaobject>   
        <section>
			<title>Opciones de políticas de reglas</title>
			<itemizedlist mark="bullet">
				<listitem>
					<para><emphasis role="bold">Show only uncommented rules</emphasis></para>
					<para>Si dejamos marcada esta opción, se omiten las reglas de Snort que vienen comentadas por el proveedor. Las reglas comentadas son reglas que no se recomiendan usar, a menos que sea de forma controlada. 
					Suelen ser reglas que detectan amenazas antiguas, reglas experimentales, reglas que pueden tener un impacto elevado en el consumo de recursos, etc. (Esta opción se encuentra activada por defecto).</para>
				</listitem>
				<listitem>
					<para><emphasis role="bold">Auto resolve dependencies</emphasis></para>
					<para>Resuelve de forma automática dependencias entre reglas. (Por defecto activada).</para>
				</listitem>
				<listitem>
					<para><emphasis role="bold">Add new rules on update</emphasis></para>
					<para>Añade nuevas reglas de forma automática cuando se actualicen las versiones de reglas. (Esta opción se encuentra desactivada por defecto).</para>
				</listitem>
				<listitem>
					<para><emphasis role="bold">Block updates available</emphasis></para>
					<para>Bloquea la actualización de reglas para esta política. (Esta opción se encuentra desactivada por defecto).</para>
				</listitem>
			</itemizedlist>
        </section>
        <section>
			<title>Añadir reglas para crear nuestra política de firmas</title>
			<para>Una vez pulsamos sobre <literal>Create Policy</literal> accederemos al menú de edición de las políticas. En éste nos aparecerán, según diferentes categorías y niveles de subcategorías, las reglas que podemos usar para la creación de nuestras políticas. </para>
			<para>En principio, el número de reglas que tenemos es 0. Para poder ir  creando nuestra política, seleccionamos las reglas, 
			o categorías de reglas que nos interesen y <emphasis role="bold">le asignamos la acción que creamos conveniente (alert, drop, sdrop, ...). </emphasis> Podemos usar diferentes acciones para cada regla o conjunto de reglas.</para>
			<para><emphasis role="bold">Acciones disponibles para cada regla o conjunto de reglas</emphasis></para>
			<itemizedlist mark="bullet">
				<listitem>
					<para><emphasis role="bold">Pass:</emphasis>  permite que el paquete pase y que no se apliquen las acciones de las reglas con las que este coincide.</para>
				</listitem>
				<listitem>
					<para><emphasis role="bold">Alert:</emphasis> informa sobre el paquete tras las inspección realizada por Snort.</para>
				</listitem>
				<listitem>
					<para><emphasis role="bold">Drop:</emphasis> en caso de que el paquete coincida con la regla, se paraliza y le es notificado al usuario.</para>
				</listitem>
				<listitem>
					<para><emphasis role="bold">Sdrop (Silent Drop):</emphasis> bloquea el paquete, pero no se notifica al usuario. </para>
				</listitem>
				<listitem>
					<para><emphasis role="bold">Clear:</emphasis> No aplica acciones; limpia todas las acciones que existan sobre esa regla.</para>
				</listitem>
			</itemizedlist>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch05_img005.png"/>
				</imageobject>
				<caption>
					<para>Signature Policies de un sensor: acciones disponibles para un conjunto de reglas</para>
				</caption>
			</mediaobject>
			<para>Las acciones podemos cambiarlas directamente en el listado de  reglas o categorías, o seleccionando la regla  y pulsando el botón del margen superior derecho <literal>Change action</literal>.</para>
			<para>Una vez que se han cambiado las acciones de las reglas que nos interesen, el número de reglas totales se habrá incrementado, tal y como muestra la siguiente captura de pantalla:</para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch05_img006.png"/>
				</imageobject>
				<caption>
					<para>Cambiar acción de regla aplicada a un sensor</para>
				</caption>
			</mediaobject>		
        </section>
        <section>
			<title>Asignación de la política de firmas a un sensor</title>
			<para>Ya tenemos creada nuestra "Signature policy". Esta se encuentra disponible para asignarla a un sensor IPS. 
			Para ello, seleccionamos un sensor del listado y en el menú desplegable seleccionamos la opción <literal>Signature Policies</literal>. 
			Al acceder a la interfaz de políticas de reglas podremos visualizar la nueva política que hemos creado.</para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch05_img007.png"/>
				</imageobject>
				<caption>
					<para>Asignar la Signature Policy a un sensor</para>
				</caption>
			</mediaobject>	
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch05_img007b.png"/>
				</imageobject>
				<caption>
					<para>Asignar la Signature Policy a un sensor: confirmar la aplicación en dicho sensor</para>
				</caption>
			</mediaobject>	
			<para>Para asignar esta política al sensor  basta con pulsar el icono en el que figura la leyenda <emphasis role="bold">Assign</emphasis>. 
			La política seleccionada quedará rotulada en color verde. A continuación, pulsamos sobre el botón <literal>Apply Conf</literal> del menú superior.
			Visualizaremos la siguiente pantalla.</para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch05_img008.png"/>
				</imageobject>
				<caption>
					<para>Signature Policy aplicada a un sensor</para>
				</caption>
			</mediaobject>	
			<para>En esta pantalla tendremos un resumen de los cambios que vamos a realizar. Si todo es correcto pulsamos sobre <literal>Update</literal> para aplicar la nueva política al sensor.</para>
			<para>Este proceso puede durar varios minutos, dependiendo del número de reglas a aplicar. Todo el proceso se realizará con un trabajo en segundo plano que podremos consultar en <literal>Tools>Worker and Job Queue.</literal></para>
			<para>Una vez haya terminado el proceso de asignación, dicho sensor contará con la política aplicada.</para>
        </section>
    </section>
</chapter>
