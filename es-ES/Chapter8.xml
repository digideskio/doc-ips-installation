<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
<!ENTITY % BOOK_ENTITIES SYSTEM "manual.ent">
<!ENTITY PRODUCT "Documentation">
<!ENTITY BOOKID "manual">
<!ENTITY YEAR "2015">
<!ENTITY HOLDER "Eneo Tecnología S.L. |">
]>
<chapter>
	<title>Aplicar reglas a un sensor</title>
	<para>Una vez que disponemos de versiones de reglas descargadas en la sección 
	<literal>Tools>Rule's version</literal> ya estamos en condiciones de poder crear una nueva política (<emphasis role="bold">Signature policy.</emphasis>) y aplicarla a un sensor.</para> 
	<mediaobject>
		<imageobject>
			<imagedata scalefit="1" align="center" width="450" fileref="images/ch08_img001.png"/>
		</imageobject>
		<caption>
			<para>Sección Tools: Rule's versions</para>
		</caption>
	</mediaobject>
	<note>
		<title>Nota</title>
		<para>Para poder comenzar el proceso de creación de una política debemos asegurarnos de que se han creado versiones de reglas 
		y que las versiones que vamos a necesitar la creación de las políticas y su aplicación a un sensor se encuentran activadas (Tools->Rule's versions).</para>
	</note>
	<para>El proceso de creación de una nueva política se realiza desde la sección <literal>Sensors</literal>. En ella, se muestra la vista de árbol de la organización de dominios y sensores que  se ha creado en redBorder. </para>
	<para>Cada uno de los sensores registrados viene acompañado de un icono en el que se 
	indican las políticas que se le han aplicado (si las hubiera) y otro de edición que despliega un submenú en el que se encuentra la opción de edición/creación de políticas. </para>
	<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="450" fileref="images/ch08_img002.png"/>
			</imageobject>
			<caption>
				<para>Sensors->icono edición->Políticas</para>
			</caption>
		</mediaobject>
	<para>La plataforma redBorder permite la creación y aplicación de dos tipos de políticas:</para>
	<itemizedlist mark="bullet">
		<listitem>
			<para><emphasis role="bold">Signature policies:</emphasis> políticas de reglas.</para>
		</listitem>
		<listitem>
			<para><emphasis role="bold">Reputation policies:</emphasis> políticas de reputación.</para>
		</listitem>
	</itemizedlist>
    <section>
		<title>Signature Policies</title>
		<para>Una Signature Policy es un subconjunto de reglas o selección obtenida a partir de una o más "versiones" de reglas descargadas.</para>
		<para>Para crear una Signature Policy nos dirigimos a la sección <literal>Sensors</literal> 
		 hacemos clic en el icono de edición en el nivel para el que deseamos crear dicha política y seleccionamos la opción <literal>Signature Policies.</literal></para> 
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="450" fileref="images/ch08_img003.png"/>
			</imageobject>
			<caption>
				<para>Sensors-> Signature Policies</para>
			</caption>
		</mediaobject>
		<para>En la interfaz de Signature Policies se muestran todas las políticas creadas y asignadas a ese sensor. La información que se muestra es la siguiente: Nombre, fuentes de las reglas que se incluyen en la política,
		 número de reglas incluidas en la política (Rules), propietario de la política (Owner), estado y fecha de creación de la política.</para>
		 <para>La política que está aplicada al sensor se muestra destacada en verde.</para>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="450" fileref="images/ch08_img004.png"/>
			</imageobject>
			<caption>
				<para>Interfaz de Signature Policies</para>
			</caption>
        </mediaobject>
        <section>
			<title>Creación de una nueva Signature Policy</title>
			<para>Para la creación de una nueva política, hacer clic en <literal>+New Policy.</literal> A continuación visualizaremos una ventana emergente en la que introduciremos la siguiente información:</para>
			<itemizedlist mark="bullet">
				<listitem>
					<para><emphasis role="bold">Nombre</emphasis></para>
				</listitem>
				<listitem>
					<para><emphasis role="bold">Descripción</emphasis></para>
				</listitem>
				<listitem>
					<para><emphasis role="bold">Dueño (owner):</emphasis> dominio, sensor, grupo o binding al que se le aplica la política. </para>
				</listitem>
				<listitem>
					<para><emphasis role="bold">Fuentes de las reglas (Rule's sources):</emphasis> seleccionar una o más fuentes y elegir la versión de esa fuente de reglas que se desea aplicar en la creación de esta política.</para>
				</listitem>
				<listitem>
					<para><emphasis role="bold">Opciones (Options)</emphasis></para>
				</listitem>
			</itemizedlist>
			<para>Una vez que se ha introducido toda esta información, hacer clic en <literal>Create Policy</literal> para añadir la nueva política al sensor.</para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch08_img005.png"/>
				</imageobject>
				<caption>
					<para>Crear una nueva política de reglas</para>
				</caption>
			</mediaobject> 
			<section>
				<title>Opciones: notificación de actualizaciones y acciones para nuevas reglas</title>
				<itemizedlist mark="bullet">
					<listitem>
						<para><emphasis role="bold">Show only uncommented rules</emphasis></para>
						<para>Si dejamos marcada esta opción, se omiten las reglas de Snort que vienen comentadas por el proveedor, es decir aquellas que no se encuentran activas.
						 Las reglas comentadas son reglas que no se recomiendan usar, a menos que sea de forma controlada. 
						Suelen ser reglas que detectan amenazas antiguas, reglas experimentales, reglas que pueden tener un impacto elevado en el consumo de recursos, etc. (Esta opción se encuentra activada por defecto).</para>
					</listitem>
					<listitem>
						<para><emphasis role="bold">Auto resolve dependencies</emphasis></para>
						<para>Resuelve de forma automática los problemas de dependencia que puedan existir entre las reglas de Snort. (Activada por defecto).</para>
					</listitem>
					<listitem>
						<para><emphasis role="bold">Add new rules on update</emphasis></para>
						<para>Añade nuevas reglas de forma automática cuando se actualicen las versiones de reglas. 
						Además, el usuario puede establecer qué acción se va a llevar a cabo en las nuevas reglas: seleccionar entre las opciones que se muestran en el desplegable. (Esta opción se encuentra desactivada por defecto).</para>
					</listitem>
					<listitem>
						<para><emphasis role="bold">Block updates available</emphasis></para>
						<para>Al seleccionar esta opción, el usuario no será notificado de las actualizaciones que existan para las reglas de Snort seleccionadas para su aplicación en la política. (Esta opción se encuentra desactivada por defecto).</para>
					</listitem>
				</itemizedlist>
				<mediaobject>
					<imageobject>
						<imagedata scalefit="1" align="center" width="450" fileref="images/ch08_img006.png"/>
					</imageobject>
					<caption>
						<para>Opciones: notificación de actualizaciones y acciones para nuevas reglas</para>
					</caption>
				</mediaobject> 
			</section>
		</section>
        <section>
			<title>Configuración de una nueva Signature Policy</title>
			<para>Una vez que pulsamos sobre <literal>Create Policy</literal> accederemos al panel de reglas. En él realizaremos fundamentalmente dos acciones: </para>
			<orderedlist numeration="arabic">
				<listitem>
					<para>Activar las reglas que queremos añadir a la política.</para>
				</listitem>
				<listitem>
					<para>Definir las acciones que queremos aplicar para cada regla. </para>
				</listitem>
			</orderedlist> 
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch08_img007.png"/>
				</imageobject>
				<caption>
					<para>Interfaz de reglas de las Signature Policies</para>
				</caption>
			</mediaobject> 
			<para><emphasis role="bold">Activar las reglas que queremos añadir a la política </emphasis></para>
			<para>En este panel encontramos un listado que incluye las reglas que tenemos disponibles clasificadas por categorías, subcategorías y reglas según el mensaje que engloba ese conjunto o tipo de reglas. </para>
			<para>En la columna derecha visualizamos el número de reglas seleccionadas/número de reglas que se incluyen en esa categoría o subcategoría 
			(ejemplo: 0/1614. Donde 0 es el número de reglas seleccionadas y 1614 el número de reglas disponibles en la categoría ATTACKS). </para>
			<para>En principio, el número de reglas que tenemos seleccionadas para la configuración de la política es cero.
			Para configurar la política que acabamos de crear debemos seleccionar las categorías, subcategorías o reglas que nos interesan: </para>	
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch08_img008.png"/>
				</imageobject>
				<caption>
					<para>Selección de reglas para la configuración de una Signature Policy</para>
				</caption>
			</mediaobject>
			<section>
				<title>Definir las acciones para cada regla</title>
				<para>Es posible definir de manera manual las acciones por categoría, subcategoría o reglas.</para>
				<para>Seleccionar todos: activar el check que se encuentra en la primera fila.</para>
				<para><emphasis>Acciones disponibles para cada regla o conjunto de reglas</emphasis></para>
				<itemizedlist mark="bullet">
					<listitem>
						<para><emphasis role="bold">Pass:</emphasis>  permite que el paquete pase y que no se apliquen las acciones de las reglas con las que este coincide.</para>
					</listitem>
					<listitem>
						<para><emphasis role="bold">Alert:</emphasis> informa sobre el paquete tras las inspección realizada por Snort.</para>
					</listitem>
					<listitem>
						<para><emphasis role="bold">Drop:</emphasis> en caso de que el paquete coincida con la regla, se paraliza y le es notificado al usuario.</para>
					</listitem>
					<listitem>
						<para><emphasis role="bold">Sdrop (Silent Drop):</emphasis> bloquea el paquete, pero no se notifica al usuario. </para>
					</listitem>
					<listitem>
						<para><emphasis role="bold">Clear:</emphasis> No aplica acciones; limpia todas las acciones que existan sobre esa regla.</para>
					</listitem>
				</itemizedlist>
				<mediaobject>
					<imageobject>
						<imagedata scalefit="1" align="center" width="450" fileref="images/ch08_img010.png"/>
					</imageobject>
					<caption>
						<para>Signature Policies: acciones disponibles para un conjunto de reglas</para>
					</caption>
				</mediaobject>
				<para>Una vez que se han cambiado las acciones de las reglas que nos interesen, el número de reglas totales se habrá incrementado, tal y como muestra la siguiente captura de pantalla:</para>
				<mediaobject>
					<imageobject>
						<imagedata scalefit="1" align="center" width="450" fileref="images/ch08_img011.png"/>
					</imageobject>
					<caption>
						<para>Reglas añadidas a la política con acciones establecidas</para>
					</caption>
				</mediaobject>
				<para><emphasis role="bold">Opciones disponibles en el panel de reglas</emphasis></para>
				<para>El submenú que se muestra en el panel de reglas incluye una serie de acciones que nos permiten afinar la configuración de las reglas que vamos a aplicar 
				así como ejecutar acciones en bloque sobre las mismas:</para>
				<itemizedlist mark="bullet">
					<listitem>
						<para><literal>Change actions:</literal> esta opción permite aplicar acciones en bloque sobre las reglas.  
						Para ello, basta con seleccionar el conjunto de reglas al que queremos aplicar la acción (activación del check) y seleccionar en el menú de opciones la acción que deseamos realizar,
						o bien, seleccionar alguno de los grupos predefinidos para las reglas:</para>
						<para>-Pass</para>
						<para>-Alert</para>
						<para>-Drop</para>
						<para>-Sdrop</para>
						<para>-Clear</para>
						<para><emphasis role="bold">Grupos predefinidos para reglas:</emphasis><footnote><para>Estos grupos han sido reados por el equipo de VRT, 
						redBorder ha realizado una selección de reglas para que estos grupos se apliquen del mismo modo en las reglas ET. </para></footnote></para>
						<para>-Connectivity: aplica todas las reglas que aseguran la conectividad.</para>
						<para>-Balanced: aplica aquellas reglas que aseguran tanto la seguridad como la conectividad.</para>
						<para>-Security: aplica aquellas reglas que aseguran la seguridad. (Inconveniente: pueden generar muchos falsos positivos).</para>
						<mediaobject>
							<imageobject>
								<imagedata scalefit="1" align="center" width="450" fileref="images/ch08_img009.png"/>
							</imageobject>
							<caption>
								<para>Change Actions</para>
							</caption>
						</mediaobject>
					</listitem>
					<listitem>
						<para><literal>Signature's rules->Event Rules:</literal> permite realizar la configuración de una serie de filtros para los eventos asociados a las reglas.</para> 	
					</listitem>
					<listitem>
						<para><literal>Options:</literal> en este apartado se encuentran las siguientes opciones:</para>
						<para>-Export to CSV: exporta las reglas de la política a formato CSV.</para>
						<para>-Import to CSV: permite cargar un archivo CSV con reglas para asignar a la política.</para>
						<para>-Create Snapshots: permite realizar una copia o captura (versión) del estado actual de las reglas para su aplicación en diferentes políticas. </para>
						<mediaobject>
							<imageobject>
								<imagedata scalefit="1" align="center" width="450" fileref="images/ch08_img015.png"/>
							</imageobject>
							<caption>
								<para>Crear una nueva snapshot</para>
							</caption>
						</mediaobject>
						<para>-<emphasis role="bold">Apply Conf:</emphasis> crea la política incluyendo las reglas y las acciones seleccionadas.</para>
					</listitem>
				</itemizedlist>		
			</section>
			<section>
				<title>Filtrado de eventos</title>
				<para><literal>Signature's rules->Event Rules:</literal> Estos filtros limitan el número de veces que un evento debe ser registrado por el sistema durante un intervalo de tiempo específico.</para>
				<para>Esta funcionalidad se utiliza para reducir el número de alertas registradas para las reglas más "ruidosas". También puede ser utilizado para reducir de manera significativa las falsas alarmas.</para>
				<para>Al hacer clic sobre esta opción, visualizamos un panel con el listado total de las reglas, en este panel podremos determinar el umbral máximo o mínimo del número de ocurrencias y 
				el tiempo que debe transcurrir para que se muestre una alerta para cada regla. Para realizar esta configuración, hacer clic en el icono de Edición que se encuentra junto a cada regla. 
				También es posible desde esta interfaz eliminar una o más reglas.</para>
				<mediaobject>
					<imageobject>
						<imagedata scalefit="1" align="center" width="450" fileref="images/ch08_img013.png"/>
					</imageobject>
					<caption>
						<para>Signature's rules->Event rules</para>
					</caption>
				</mediaobject>
				<para>En la ventana emergente encontraremos los siguientes tipos de filtrado:</para>
				<para>-Threshold: alerta cada n veces que se produzca un evento en el intervalo de tiempo determinado. </para>
				<para>-Limit: limita el número de eventos que se muestran en el intervalo de tiempo indicado 
				ignorando los demás eventos que se produzcan bajo la misma firma.</para>
				<para>-Both: la alerta solo se muestra una vez por cada n veces que ha sucedido el evento en el intervalo de tiempo indicado, ignorando cualquier evento adicional que se produzca durante ese intervalo de tiempo.</para>
				<para><emphasis>Track:</emphasis> indicar qué eventos deben ser limitados, por origen o destino. (By source/By destination).</para>
				<para><emphasis>Count/Seconds:</emphasis> en este apartado se determinan el número de ocurrencias del evento (Count) y el intervalo de tiempo (Seconds).</para>
				<para><emphasis>Comment:</emphasis> el usuario puede añadir comentarios que le ayuden a identificar los límites/filtros establecidos para la regla seleccionada.</para>
				<para>Para guardar la configuración del filtro hacer clic en <literal>Update Event Filter.</literal></para>
				<mediaobject>
					<imageobject>
						<imagedata scalefit="1" align="center" width="450" fileref="images/ch08_img012.png"/>
					</imageobject>
					<caption>
						<para>Editar detalles de filtrado de eventos para cada regla</para>
					</caption>
				</mediaobject>		
			</section>
        </section> 
        <section>
			<title>Asignación de la política de firmas a un sensor</title>
			<para>Ya tenemos creada nuestra "Signature policy". Esta se encuentra disponible para asignarla a un sensor IPS/IDS. 
			Si acabamos de crear la política y nos encontramos en la interfaz de Signature Policies de un sensor, 
			basta con hacer clic en la opción <literal>Assign</literal> para asignar la política y a continuación, <literal>Apply Conf</literal> para aplicar la nueva configuración al sensor.</para>
			<para>Esta operación puede realizarse también desde la sección <emphasis role="bold">Sensors</emphasis> hacer clic en el icono Editar del sensor y seleccionar la opción <literal>Signature Policies</literal>. 
			en la que repetiremos la operación antes descrita.</para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch08_img016.png"/>
				</imageobject>
				<caption>
					<para>Signature Policies: políticas disponibles para un sensor</para>
				</caption>
			</mediaobject>	
			<para>Para asignar esta política al sensor  basta con pulsar el icono en el que figura la leyenda <emphasis role="bold">Assign</emphasis>. El sistema abrirá una ventana emergente avisando de 
			que la asignación de la política a ese sensor afectará a todos los "hijos" que tenga por debajo. <footnote><para>En el apartado de <emphasis role="bold">Herencias de las políticas</emphasis> se explican con detalle </para></footnote></para>
			<note>
				<title>Nota</title>
				<para>Un sensor, grupo o binding puede ser propietario (Owner) de múltiples políticas, pero solo es posible aplicar una política para cada sensor, grupo o binding. 
				La política asignada quedará sombreada en verde.</para>
			</note>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch08_img017.png"/>
				</imageobject>
				<caption>
					<para>Aplicar una política a un sensor y a todos los "hijos" que haya por debajo</para>
				</caption>
			</mediaobject>
			<para>La política seleccionada quedará sombreada en color verde. A continuación, pulsamos sobre el botón <literal>Apply Conf</literal> del menú superior para aplicar la política asignada al sensor.</para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch08_img018.png"/>
				</imageobject>
				<caption>
					<para>Signature Policy aplicada a un sensor</para>
	 			</caption>
			</mediaobject>	
			<para>Una vez que se ha aplicado la nueva configuración accedemos a una pantalla en la que se muestran las últimas actualizaciones (<literal>Configuration Update</literal>).
			En esta pantalla tendremos un resumen de las políticas aplicadas al sensor (Signature Policies y Reputation Policies). Si todo es correcto pulsamos sobre <literal>Update</literal> para actualizar la configuración del sensor.</para>
			<para>Este proceso puede durar varios minutos, dependiendo del número de reglas a aplicar. Todo el proceso se realizará con un trabajo en segundo plano que podremos consultar en <literal>Tools->Worker &Aacute; Job Queue.</literal></para>
			<para>Una vez haya terminado el proceso de asignación, dicho sensor contará con la política aplicada.</para>
			<section>
				<title>Acciones disponibles para la gestión de las políticas</title>
				<para>En el icono de Edición que encontramos para las políticas que se muestran en el panel de Signature Policies encontramos las siguientes opciones:</para>
				<itemizedlist>
					<listitem>
						<para>Edit: permite editar la configuración de la política.</para>
					</listitem>
					<listitem>
						<para>Rules: esta opción nos dirige al panel de reglas.</para>
					</listitem>
					<listitem>
						<para>Clone: crea una copia de la política seleccionada.</para>
					</listitem>
					<listitem>
						<para>Snapshots: permite realizar una copia o captura (versión) del estado actual de las políticas.</para>
					</listitem>
					<listitem>
						<para>Event rules: permite establecer límites (máximos y mínimos) del número de ocurrencias de un evento para que se envíe una alarma.</para>
					</listitem>
				</itemizedlist>
			</section>
			<section>
				<title>Snapshots</title>
				<para>Las snapshots son "capturas" o copias de las reglas o de las políticas. De este modo, el usuario puede crear una especie de repositorio de "versiones" de una política o regla que tendrá disponible para 
				su uso posterior. Las snapshots guardan la configuración y el estado actual de la regla o política; tan solo es editable su nombre o etiqueta. 
				Se trata de un recurso muy útil en caso de querer recuperar la configuración que una política (o conjunto de reglas) ha tenido en un momento determinado.</para>
				<para>Esta opción es accesible desde las siguientes rutas:</para>
				<itemizedlist mark="bullet">
					<listitem>
						<para>Panel Signature Policies: Icono editar-><literal>Snapshots</literal></para>
					</listitem>
					<listitem>
						<para>Panel rules: Icono editar-><literal>Rules->Options-> Create Snapshots</literal></para>
						<para>Panel rules: Icono editar-><literal>Rules->Options->Snapshots</literal> </para>
					</listitem>
				</itemizedlist>
				<mediaobject>
					<imageobject>
						<imagedata scalefit="1" align="center" width="450" fileref="images/ch08_img018b.png"/>
					</imageobject>
					<caption>
						<para>Signature Policy: panel de Snapshots</para>
					</caption>
				</mediaobject>
				<para>En esta pantalla encontramos un listado con las Snapshots que se encuentran disponibles y la información asociada a ellas: Nombre (Tag), Usuario que las ha creado, Timestamp (fecha y hora de la captura), nº reglas (Rules).</para>
				<para>Tanto desde el panel de políticas como el de reglas accederemos al listado de Snapshots disponibles. En él, podremos realizar las siguientes acciones sobre las Snapshots:</para>
				<itemizedlist mark="circle">
					<listitem>
						<para>Editar (Edit): permite la edición del nombre o tag.</para>
					</listitem>
					<listitem>
						<para>Cargar (Load): carga esa versión o snapshot; dicha política será la que se aplique al sensor correspondiente.</para>
					</listitem>
					<listitem>
						<para>Descargar (Download): permite la descarga de la snapshot en formato CSV.</para>
					</listitem>
					<listitem>
						<para>Eliminar</para>
					</listitem>
				</itemizedlist>	
				<mediaobject>
					<imageobject>
						<imagedata scalefit="1" align="center" width="450" fileref="images/ch08_img018c.png"/>
					</imageobject>
					<caption>
						<para>Signature Policy: Rules->Snapshots</para>
					</caption>
				</mediaobject>	
				<para><emphasis role="bold">Crear una nueva snapshot desde el panel de reglas</emphasis>: introducir una etiqueta descriptiva (Tag) y hacer clic en <literal>Create.</literal></para>
				<mediaobject>
					<imageobject>
						<imagedata scalefit="1" align="center" width="450" fileref="images/ch08_img018d.png"/>
					</imageobject>
					<caption>
						<para>Rules->Create Snapshots</para>
					</caption>
				</mediaobject>	
			</section>	
        </section>
        <section>
			<title>Herencias de las políticas</title>
			<para>Como hemos visto anteriormente, <footnote><para>Consultar capítulo 5: "Sensores" para más información sobre dependencias y organización jerárquica en redBorder.</para></footnote> la organización de los elementos de red 
			creados en redBorder es jerárquica y por tanto, establece dependencias entre niveles y otros.</para>
			<para>Estas dependencias establecen un sistema de herencias que afecta tanto en la configuración como en las políticas aplicadas en cada uno de los niveles (de mayor a menor jerarquía):</para>
			<itemizedlist>
				<listitem>
					<para>Root</para>
				</listitem>
				<listitem>
					<para>Dominio</para>
				</listitem>
				<listitem>
					<para>Sensores</para>
				</listitem>
				<listitem>
					<para>Grupo</para>
				</listitem>
				<listitem>
					<para>Binding</para>
				</listitem>
			</itemizedlist>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch08_img019.png"/>
				</imageobject>
				<caption>
					<para>Sensors->Tree: jerarquías y dependencias entre niveles</para>
	 			</caption>
			</mediaobject>	
			<note>
				<title>Nota</title>
				<para>El sistema de herencias establece que la configuración de los niveles superiores afecta a la de aquellos "hijos" que cuelguen o dependan de ellos. En caso de que no se edite la configuración de dichos hijos,
				el sistema asignará por defecto las políticas, modos y configuraciones asignadas al nivel "padre". 
				<emphasis role="bold">El sistema de herencias se establece por tanto, desde los niveles superiores y aplicará a los niveles inferiores que cuelguen de él.</emphasis></para>
			</note>
			<para>En la sección <literal>Tools</literal> encontramos la opción de <literal>General Settings</literal> desde la cual el usuario puede establecer la configuración de los parámetros generales del Manager, 
			así como de las Apps que tenga registradas. </para>
			<para>Este es el máximo nivel de configuración (es como si se tratara del dominio <emphasis role="bold">root</emphasis>) por lo que las propiedades que aquí se definan serán heredadas 
			por el resto de dominios y sensores que se encuentren por debajo de este nivel.</para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch08_img020.png"/>
				</imageobject>
				<caption>
					<para>Configuración de sensores IPS/IDS heredada del "root"</para>
	 			</caption>
			</mediaobject>	
			<para>Cuando se crea un dominio o sensor o se edita por primera vez, obervaremos que algunos parámetros vienen acompañados de la etiqueta 
			<emphasis role="bold">"Inherited"</emphasis>, esto quiere decir que han heredado los valores heredados de la configuración general del Manager. 
			Para cambiar esta configuración, el usuario deberá sobreescribir esa información.</para>
			<para><emphasis role="bold">Aplicar diferentes políticas en cada uno de los niveles existentes</emphasis></para>
			<para>Una de las nuevas funcionalidades de la web redBorder es la posibilidad de crear grupos de sensores y bindings. Esto aumenta la flexibilidad asociada al software, ya que, a diferencia de la anterior versión en la que una política debía aplicarse por completo para un sensor (independientemente de los segmentos creados),
			 permite la formación de grupos de segmentos y bindings independientes.</para>
			<note>
				<title>Nota</title>
				<para>Gracias a los grupos de sensores y bindings, con una sola máquina, el usuario puede crear numerosos entornos para aplicar diferentes reglas.</para>
				<para><emphasis role="bold">Owner:</emphasis> establece a partir de qué nivel deben aplicarse las políticas.</para>
			</note>
			<para>Para crear o aplicar políticas de manera independiente en cada uno de los diferentes niveles que tengamos, basta con situarse en dicho nivel y realizar el proceso de creación y asignación de políticas.
			De este modo, el sistema establece, por defecto, que ese nivel es el dueño u "owner" de la política y la aplicará desde ese nivel hacia los inferiores. </para>
			<para>Al crear una nueva política se puede elegir quién será el "owner" o propietario de la misma. En este caso, nos encontraremos un desplegable en el que seleccionar el nivel desde el cual se va a aplicar.</para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch08_img021.png"/>
				</imageobject>
				<caption>
					<para>New Policy: determinar Owner o propietario de la política</para>
	 			</caption>
			</mediaobject>	
			<para>Para gestionar la jerarquía de los sensores y los dominios solo es necesario dirigirse a la sección <literal>Sensors</literal> (vista árbol) y mediante la acción de "selección y arrastre" situar el dominio o sensor en nivel que se desee.</para>			
        </section>
    </section>
    <section>
		<title>Reputation Policies</title>
		<para>Las políticas de reputación permiten realizar acciones de bloqueo o acceso de paquetes en nuestra red por continente, país y/o IP.</para>
		<para>Para crear una Reputation Policy nos dirigimos a la sección <literal>Sensors</literal> hacemos clic en el icono de Edición
		del nivel para el que deseamos crear dicha política y seleccionamos la opción <literal>Reputation Policies.</literal></para> 
		<warning>
			<title></title>
			<para>Es posible crear Signature Policies a nivel de dominio, sensor, grupo y binding.</para>
			<para>En el caso de las Reputation Policies <emphasis role="bold">no es posible crear políticas a nivel de binding</emphasis> solo se pueden crear a nivel de dominio, sensor y grupo.</para>
		</warning>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="450" fileref="images/ch08_img022.png"/>
			</imageobject>
			<caption>
				<para>Sensors-> Reputation Policies</para>
			</caption>
		</mediaobject>
		<para>En el panel Reputation Policies se muestran todas las políticas creadas y asignadas a ese sensor o grupo. La información que se muestra es la siguiente: Nombre y propietario de la política.</para>
		<mediaobject>
			<imageobject>
				<imagedata scalefit="1" align="center" width="450" fileref="images/ch08_img023.png"/>
			</imageobject>
			<caption>
				<para>Interfaz de Reputation Policies</para>
			</caption>
        </mediaobject>
        <section>
			<title>Acciones disponibles para la gestión de las políticas de reputación</title>
			<para>En el icono de Edición que encontramos para las políticas que se muestran en el panel de Reputation Policies encontramos las siguientes opciones:</para>
			<itemizedlist>
				<listitem>
					<para>Edit: permite editar la configuración de la política.</para>
				</listitem>
				<listitem>
					<para>Rules: esta opción nos dirige al panel de reglas.</para>
				</listitem>
				<listitem>
					<para>Clone: crea una copia de la política seleccionada.</para>
				</listitem>
			</itemizedlist>
		</section>
        <section>
			<title>Creación de una nueva Reputation Policy</title>
			<para>La creación de una nueva política de reputación se realiza desde el panel de Reputation Policies accesible desde Sensors->icono edición->Reputation Policies. En esta pantalla, hacer clic en <literal>+New Rep Policy</literal>
			y completar la información que solicita el sistema: Nombre y comentarios; a continuación, hacer clic en el botón <literal>Create Reputation policy.</literal></para>
			<para><emphasis role="bold">Añadir una nueva regla de reputación a la política</emphasis></para>
			<para>Una vez que se ha creado la política de reputación accedemos a la interfaz de reglas desde la que se pueden añadir, editar y eliminar las reglas de reputación de dicha política. Para crear una regla, seleccionar la opción <literal>+Add.</literal></para>
			<para>Introducir los siguientes datos y hacer clic en <literal>Create Reputation</literal> para añadir una nueva regla a la política.</para>
			<itemizedlist mark="bullet">
				<listitem>
					<para>Action</para>
					<para>-Analize: permite excluir del bloqueo (drop) una red, continente o país</para>
					<para>-Drop: bloquea el paso del paquete procedente de esa red, continente o país.</para>
					<para>-Bypass: permite el paso del paquete procedente de esa red, continente o país.</para>
				</listitem>
				<listitem>
					<para>Value/Continent/Country: insertar el valor de la IP o seleccionar en el desplegable el continente o país sobre el que se desea aplicar la acción indicada.</para>
					<para>El continente o país que se haya seleccionado aparecerá coloreado en el mapa con el color que representa la acción correspondiente.</para>
				</listitem>
			</itemizedlist>
			<para><emphasis role="bold">Opciones</emphasis></para>
			<para>Hacer clic en <literal>Options->Apply Conf</literal> para aplicar las reglas a la política de reputación recién creada.</para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch08_img024.png"/>
				</imageobject>
				<caption>
					<para>Añadir reglas de reputación</para>
				</caption>
			</mediaobject>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch08_img025.png"/>
				</imageobject>
				<caption>
					<para>Reglas de reputación</para>
				</caption>
			</mediaobject>
			<para><mphasis role="bold">Opciones disponibles en el panel de reglas</mphasis></para>
			<itemizedlist mark="bullet">
				<listitem>
					<para>Apply conf: incluye las reglas recién creadas en la política correspondiente.</para>
				</listitem>
				<listitem>
					<para>Import CSV: Importar reglas de reputación para añadir a la política desde un archivo CSV <literal>(Options->Import from CSV).</literal></para>
				</listitem>
				<listitem>
					<para>Export CSV: Exporta las reglas incluidas en la política a un archivo CSV que el usuario tendrá disponible para su uso en otras aplicaciones. <literal>(Options->Import from CSV).</literal></para>
				</listitem>
			</itemizedlist>
		</section>
		<section>
			<title>Asignación de la política de reputación a un sensor</title>
			<para>Ya tenemos creada nuestra "Reputation policy". Esta se encuentra disponible para asignarla a un sensor IPS/IDS. 
			Si acabamos de crear la política y nos encontramos en la interfaz de Reputation Policies de un sensor, 
			basta con hacer clic en la opción <literal>Assign</literal> para asignar la política y a continuación, <literal>Apply Conf</literal> para aplicar la nueva configuración al sensor.</para>
			<para>Esta operación puede realizarse también desde la sección <emphasis role="bold">Sensors</emphasis> hacer clic en el icono Editar del sensor y seleccionar la opción <literal>Reputation Policies</literal>. 
			en la que repetiremos la operación antes descrita.</para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch08_img026.png"/>
				</imageobject>
				<caption>
					<para>Reputation Policies: políticas disponibles para un sensor</para>
				</caption>
			</mediaobject>	
			<para>Para asignar esta política al sensor  basta con pulsar el icono en el que figura la leyenda <emphasis role="bold">Assign</emphasis>. El sistema abrirá una ventana emergente avisando de 
			que la asignación de la política a ese sensor afectará a todos los "hijos" que tenga por debajo. <footnote><para>En el apartado de <emphasis role="bold">Herencias de las políticas</emphasis> se explican con detalle </para></footnote></para>
			<note>
				<title>Nota</title>
				<para>Un sensor o grupo puede ser propietario (Owner) de múltiples políticas, pero solo es posible aplicar una política para cada sensor o grupo. 
				La política asignada quedará sombreada en verde.</para>
			</note>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch08_img027.png"/>
				</imageobject>
				<caption>
					<para>Aplicar una política a un sensor y a todos los "hijos" que haya por debajo</para>
				</caption>
			</mediaobject>
			<para>La política seleccionada quedará sombreada en color verde. A continuación, pulsamos sobre el botón <literal>Apply Conf</literal> del menú superior para aplicar la política asignada al sensor.</para>
			<mediaobject>
				<imageobject>
					<imagedata scalefit="1" align="center" width="450" fileref="images/ch08_img018.png"/>
				</imageobject>
				<caption>
					<para>Reputation Policy aplicada a un sensor</para>
	 			</caption>
			</mediaobject>	
			<para>Una vez haya terminado el proceso de asignación, dicho sensor contará con la política aplicada.</para>			
		</section>
	</section> 
</chapter>
